{
  "version": 3,
  "sources": ["../../src/lib/tools.ts"],
  "sourcesContent": ["import crypto from 'crypto';\n\nexport async function _translate(word: string, systemLang: string): Promise<string> {\n    return new Promise(async (resolve) => {\n        const translations = await import(`../../admin/i18n/${systemLang ? systemLang : 'en'}/translations.json`);\n        if (translations[word]) {\n            resolve(translations[word]);\n        } else {\n            console.warn(`Please translate in translations.json: ${word}`);\n            resolve(word);\n        }\n    });\n}\n\nexport async function generateRandomToken(length: number): Promise<string> {\n    return new Promise((resolve) => {\n        const randomToken = crypto.randomBytes(length).toString('base64url');\n        resolve(randomToken);\n    });\n}\n\nexport async function computeCodeChallenge(token: string): Promise<string | null> {\n    return new Promise((resolve) => {\n        const hash = crypto.createHash('sha256');\n        hash.update(token);\n        const digest = hash.digest();\n\n        const base64Url = digest.toString('base64')\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/=+$/, '');\n\n        resolve(base64Url);\n    });\n}\n\nexport async function randomBytes(length: number): Promise<string | null> {\n    return new Promise((resolve) => {\n        const _randomBytes = crypto.randomBytes(length).toString('base64url');\n        resolve(_randomBytes);\n    });\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAmB;AAEnB,eAAsB,WAAW,MAAc,YAAqC;AAChF,SAAO,IAAI,QAAQ,OAAO,YAAY;AAClC,UAAM,eAAe,MAAM,6BAAO,QAAP,QAAO,oBAAoB,aAAa,aAAa,IAAI,oBAAoB;AACxG,QAAI,aAAa,IAAI,GAAG;AACpB,cAAQ,aAAa,IAAI,CAAC;AAAA,IAC9B,OAAO;AACH,cAAQ,KAAK,0CAA0C,IAAI,EAAE;AAC7D,cAAQ,IAAI;AAAA,IAChB;AAAA,EACJ,CAAC;AACL;AAEA,eAAsB,oBAAoB,QAAiC;AACvE,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,UAAM,cAAc,cAAAA,QAAO,YAAY,MAAM,EAAE,SAAS,WAAW;AACnE,YAAQ,WAAW;AAAA,EACvB,CAAC;AACL;AAEA,eAAsB,qBAAqB,OAAuC;AAC9E,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,UAAM,OAAO,cAAAA,QAAO,WAAW,QAAQ;AACvC,SAAK,OAAO,KAAK;AACjB,UAAM,SAAS,KAAK,OAAO;AAE3B,UAAM,YAAY,OAAO,SAAS,QAAQ,EACrC,QAAQ,OAAO,GAAG,EAClB,QAAQ,OAAO,GAAG,EAClB,QAAQ,OAAO,EAAE;AAEtB,YAAQ,SAAS;AAAA,EACrB,CAAC;AACL;AAEA,eAAsB,YAAY,QAAwC;AACtE,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,UAAM,eAAe,cAAAA,QAAO,YAAY,MAAM,EAAE,SAAS,WAAW;AACpE,YAAQ,YAAY;AAAA,EACxB,CAAC;AACL;",
  "names": ["crypto"]
}
